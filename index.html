<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Path of Hideout — Flips</title>
    <meta name="description" content="Essence Flip and Fossil Flip — quick tools" />
    <style>
      :root{
        --bg1: linear-gradient(135deg,#0f172a 0%,#0b1220 50%,#071127 100%);
        --card:#0b1226;
        --muted:#9aa4b2;
        --accent:#6ee7b7;
        --glass: rgba(255,255,255,0.03);
        --radius:14px;
        color-scheme: dark;
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      }
      html,body{height:100%;margin:0}
      body{
        display:flex;align-items:flex-start;justify-content:center;
        background:var(--bg1);background-size:200% 200%;
        padding:48px;color:#e6eef6;line-height:1.4;
      }
      .container{
        width:100%;max-width:1400px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
        border-radius:var(--radius);box-shadow:0 10px 30px rgba(2,6,23,0.6);
        overflow:hidden;border:1px solid rgba(255,255,255,0.03);
      }
      header{display:flex;align-items:center;justify-content:space-between;padding:20px 24px}
      .brand{display:flex;gap:12px;align-items:center}
      .logo{width:44px;height:44px;background:linear-gradient(135deg,var(--accent),#60a5fa);border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;color:#052225}
      h1{font-size:18px;margin:0}
      p.lead{margin:0;color:var(--muted);font-size:13px}

      /* Tabs */
      .tabs{display:flex;gap:8px;padding:12px 20px;background:var(--glass);border-top:1px solid rgba(255,255,255,0.02);}
      .tab{background:transparent;border:0;padding:10px 14px;border-radius:10px;color:var(--muted);cursor:pointer;font-weight:600}
      .tab[aria-selected="true"]{background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));color:var(--accent);box-shadow:inset 0 -2px 0 rgba(0,0,0,0.4)}
      .tab:focus{outline:2px solid rgba(110,231,183,0.18);outline-offset:2px}

      .panel-wrap{display:flex;padding:28px;gap:24px;flex-wrap:wrap}
      .panel{flex:1 1 320px;min-width:260px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)}
      .panel h2{margin:0 0 8px 0;font-size:16px}
      .muted{color:var(--muted);font-size:13px}
      .hint{margin-left:8px;color:var(--muted);cursor:help;font-size:12px;vertical-align:middle}
      .cta{margin-top:12px;display:inline-flex;gap:8px}
      .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:10px;color:var(--accent);cursor:pointer}

      footer{padding:14px 20px;color:var(--muted);font-size:13px;border-top:1px solid rgba(255,255,255,0.02);}

      @media (max-width:640px){body{padding:16px}.panel-wrap{padding:18px;gap:12px}}
      /* Results table styling */
      #results{overflow-x:auto}
      .results-table{width:100%;border-collapse:collapse;table-layout:fixed}
      .results-table col{width:25%}
      .results-table th, .results-table td{padding:6px 10px;vertical-align:middle}
      .results-table th{font-weight:600}
      .results-table td{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    </style>
  </head>
  <body>
    <div class="container" role="application">
      <header>
        <div class="brand">
          <div class="logo">PH</div>
          <div>
            <h1>Path of Hideout</h1>
            <p class="lead">Quick helpers for Essence and Fossil flipping</p>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:8px">
          <label for="leagueSelect" style="color:var(--muted);font-size:13px;margin:0">League</label>
          <select id="leagueSelect" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);color:inherit">
            <option value="Keepers">Temporary League</option>
            <option value="Standard" selected>Standard League</option>
          </select>
        </div>
      </header>

      <nav class="tabs" role="tablist" aria-label="Flip tools">
        <button class="tab" role="tab" id="tab-essence" aria-controls="panel-essence" aria-selected="true">Essence Flip</button>
        <button class="tab" role="tab" id="tab-fossil" aria-controls="panel-fossil" aria-selected="false">Fossil Flip</button>
      </nav>

      <main>
        <div class="panel-wrap">
          <section class="panel" id="panel-essence" role="tabpanel" aria-labelledby="tab-essence">
            <h2>Essence Flip</h2>
            <p class="muted">Tool to compute an optimal stop-threshold for flipping essence tiers using Harvest (uniform swap) with a swap cost. If you are interested, this is the <a href="https://github.com/bholms/PathOfHideout/blob/main/docs/essence-flip-math.md" target="_blank" style="color:var(--accent);text-decoration:underline">math</a> behind it.</p>

            <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:12px">
              <label style="flex:1 1 160px">Start count<br><input id="startCount" type="number" min="1" value="10" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit"></label>
              <label style="flex:1 1 220px">Start type<br><select id="startType" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);color:inherit"></select></label>
              <label style="flex:1 1 160px">Blue lifeforce per div <span class="hint" title="Number of blue lifeforce per 1 Divine Orb">ⓘ</span><br><input id="bluePerDiv" type="number" min="0.0001" step="0.001" value="6000" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit"></label>
              <label style="flex:1 1 160px">Chaos per div <span class="hint" title="Chaos value gained by selling one div"><span class="hint">ⓘ</span></span><br><input id="chaosPerDiv" type="number" min="0" step="0.1" value="400" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit"></label>
            </div>

            <details style="margin-top:12px;background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.02)">
              <summary style="cursor:pointer">Essence prices (Defeaning tier) — edit values</summary>
              <div id="priceUnitWrap" style="margin-top:8px;display:flex;gap:10px;align-items:center;color:var(--muted);font-size:13px">
                <div style="font-weight:600">Unit:</div>
                <label style="display:flex;gap:6px;align-items:center"><input type="radio" name="priceUnit" value="chaos" checked> chaos / essence</label>
                <label style="display:flex;gap:6px;align-items:center"><input type="radio" name="priceUnit" value="essPerDiv"> essence / div</label>
                <div style="margin-left:8px;color:var(--muted);font-size:12px">(choose how you want to enter prices)</div>
              </div>
              <div id="pricesTable" style="margin-top:10px;display:flex;flex-direction:column;gap:6px"></div>
            </details>

            <div class="cta" style="margin-top:12px">
              <button class="btn" id="computeBtn">Compute Strategy</button>
              <button class="btn" id="refreshPricesBtn" style="border-color: rgba(255,255,255,0.06);">Refresh prices</button>
            </div>

            <div id="results" style="margin-top:14px"></div>
          </section>

          <section class="panel" id="panel-fossil" role="tabpanel" aria-labelledby="tab-fossil" hidden>
            <h2>Fossil Flip</h2>
            <p class="muted">Tool to compute an optimal stop-threshold for flipping fossils using Harvest (weighted swap) with a swap cost. See the <a href="docs/fossil-flip-math.md" target="_blank" style="color:var(--accent);text-decoration:underline">math</a> behind it.</p>

            <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:12px">
              <label style="flex:1 1 160px">Start count<br><input id="f_startCount" type="number" min="1" value="1" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit"></label>
              <label style="flex:1 1 220px">Start type<br><select id="f_startType" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);color:inherit"></select></label>
              <label style="flex:1 1 160px">Purple lifeforce per div <span class="hint" title="Number of purple lifeforce per 1 Divine Orb">ⓘ</span><br><input id="f_purplePerDiv" type="number" min="0.0001" step="0.001" value="6000" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit"></label>
              <label style="flex:1 1 160px">Chaos per div <span class="hint" title="Chaos value gained by selling one div"><span class="hint">ⓘ</span></span><br><input id="f_chaosPerDiv" type="number" min="0" step="0.1" value="400" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit"></label>
            </div>

            <details style="margin-top:12px;background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.02)">
              <summary style="cursor:pointer">Fossil prices & weights — edit values</summary>
              <div style="margin-top:8px;display:flex;gap:10px;align-items:center;color:var(--muted);font-size:13px">
                <div style="font-weight:600">Unit:</div>
                <label style="display:flex;gap:6px;align-items:center"><input type="radio" name="fossilPriceUnit" value="chaos" checked> chaos / fossil</label>
                <label style="display:flex;gap:6px;align-items:center"><input type="radio" name="fossilPriceUnit" value="fossPerDiv"> fossil / div</label>
                <div style="margin-left:8px;color:var(--muted);font-size:12px">(choose how you want to enter prices)</div>
              </div>
              <div id="fossilsTable" style="margin-top:10px;display:flex;flex-direction:column;gap:6px;max-height:420px;overflow:auto;padding-right:8px"></div>
            </details>

            <div class="cta" style="margin-top:12px">
              <button class="btn" id="computeFossilBtn">Compute Strategy</button>
              <button class="btn" id="refreshFossilBtn" style="border-color: rgba(255,255,255,0.06);">Refresh prices</button>
            </div>

            <div id="fossilResults" style="margin-top:14px"></div>
          </section>

        </div>
      </main>
    </div>

    <script>
      (function(){
        // Tab switching is native here; all flip logic is delegated to `poh.js`.
        const tabs = Array.from(document.querySelectorAll('.tab'));
        const panels = Array.from(document.querySelectorAll('[role="tabpanel"]'));
        function show(index, focus=true){
          tabs.forEach((t,i)=>{
            const sel = i===index;
            t.setAttribute('aria-selected', sel);
            panels[i].hidden = !sel;
          });
          if(focus) tabs[index].focus();
          try{localStorage.setItem('pohtab', index)}catch(e){}
        }
        tabs.forEach((t,i)=>{
          t.addEventListener('click', ()=> show(i,false));
          t.addEventListener('keydown', (e)=>{
            if(e.key === 'ArrowRight') show((i+1)%tabs.length);
            if(e.key === 'ArrowLeft') show((i-1+tabs.length)%tabs.length);
          });
        });
        // restore
        let start = 0;
        try{ const saved = localStorage.getItem('pohtab'); if(saved!=null) start = Number(saved); }catch(e){}
        show(start,false);
      })();
    </script>
    <script src="poh.js"></script>
  </body>
</html>
